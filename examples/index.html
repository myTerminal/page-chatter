<!DOCTYPE html>
<html>
    <head>
        <title>page-chatter example</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0" />
    </head>
    <body>
        <div id="page"></div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.5/require.js"></script>

        <script src="../build/scripts/page-chatter.js"></script>

        <script type="text/javascript">
         require(
             [
                 'pageChatter'
             ],
             function (pc) {
                 // Initialize handler
                 pc.init();

                 pc.listen(
                     'p0',
                     message => {
                         switch (message.event) {
                             case 'result':
                             alert('The result is ' + message.payLoad);
                             break;

                             case 'date':
                             alert('The date is ' + message.payLoad);
                             break;

                             default:
                             // Ignore
                         }
                     }
                 );

                 pc.listen(
                     'p1',
                     message => {
                         switch (message.event) {
                             case 'add':
                             pc.talk(
                                 'p0',
                                 'result',
                                 message.payLoad.num1 + message.payLoad.num2
                             );
                             break;

                             case 'subtract':
                             pc.talk(
                                 'p0',
                                 'result',
                                 message.payLoad.num1 - message.payLoad.num2
                             );
                             break;

                             default:
                             // Ignore
                         }
                     }
                 );

                 pc.listen(
                     'p2',
                     message => {
                         switch (message.event) {
                             case 'date':
                             pc.talk(
                                 'p0',
                                 'date',
                                 new Date().toDateString()
                             );
                             break;

                             default:
                             // Ignore
                         }
                     }
                 );

                 pc.talk(
                     'p1',
                     'add',
                     {
                         num1: 2,
                         num2: 3
                     }
                 );

                 pc.talk(
                     'p2',
                     'date'
                 );
             }
         )
        </script>
    </body>
</html>
